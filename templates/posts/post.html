<div class="container mt-5 pt-5">
	<div class="card m-auto w-75" style="">
    <article id="post-{{ post.id }}" class="post">
			<div class="card-header">
				<div class="row mt-1">
					<div class="col-6 text-start">
					<a href="{% url 'users:profile' user_id=post.user.id %}" class="text-decoration-none">
						{% if post.user.profile_image %} 
							<img src="{{ post.user.profile_image.url }}" class="rounded-circle" alt="" style="height:32px;">
						{% endif %}
						<span class="card-title fw-bold text-black">{{ post.user.username }}</span>
					</a>
				</div>
					{% comment %} follow unfollow {% endcomment %}
					<div class="col-6 text-end">
					{% if user != post.user %}
						<form action="{% url 'users:follow' user_id=post.user.id %}?next={{action_redirect_url}}" method="POST">
						{% csrf_token %}
						
							{% if post.user in user.following.all %}
							<button type="submit" class="btn btn-sm btn-outline-danger">
								Unfollow
							{% else %}
							<button type="submit" class="btn btn-sm btn-outline-success">
								Follow
							{% endif %}
						</button>
						</form>
					{% endif %}
				</div>
			</div>
				
	{% comment %} 이미지 슬라이드 {% endcomment %}
	<div class="post-images splide my-2">
		<div class="splide__track">
			<ul class="splide__list">
				{% for image in post.postimage_set.all %}
					{% if image.photo %}
						<li class="splide__slide">
							<div class="ratio ratio-4x3">
								<img src="{{ image.photo.url }}" class="card-img " style="background-size: contain">
							</div>
						</li>
					{% endif %}
				{% endfor %}
			</ul>
		</div>
	</div>
	{% comment %} 글내용 {% endcomment %}
	<div class="post-content">
		{{post.content|linebreaksbr}}
		{% comment %} 태그 {% endcomment %}
		<div class="post-tags">
			{% for tag in post.tags.all %}
				<a href="{% url 'posts:tags' tag_name=tag.name %}">#{{tag.name}}</a>
			{% endfor %}
		</div>
	</div>
</div>



<div class="card-body">
	{% comment %} 좋아요 댓글 갯수 {% endcomment %}

	<div class="post-buttons">
		<div class="d-inline-block">
		<form action="{% url 'posts:post_like' post_id=post.id %}?next={{ action_redirect_url }}" method="POST">
			{% csrf_token %}
			<button type="submit" class="btn"style="outline=none;">
				{% if user in post.like_users.all %}
					좋아요 해제({{ post.like_users.count }})
				{% else %}
					좋아요({{ post.like_users.count }})
				{% endif %}
			</button>
		</form>
	</div>
		<div class="d-inline-block">
		<span> Comments({{post.comment_set.count}}) </span>
	</div>
	</div>

	{% comment %} 댓글 {% endcomment %}
	<div class="post-comments">
		<ul class="list-group">
			{% for comment in post.comment_set.all %}
				<li class="mb-2" style="list-style:none;">
					<div class="d-inline-block">
					<span class="fw-bold"> {{comment.user.username}} </span>
					<span> {{comment.content}} </span>
					</div>
					{% if user == comment.user %}
					<div class="d-inline-block">
						<form action="{% url 'posts:comment_delete' comment_id=comment.id %}" method="post">
							{% csrf_token %}
							<button type="submit" class="btn btn-sm btn-outline-danger rounded-circle" >삭제</button>
						</form>
					{% endif %}
					</div>
				</li>
			{% endfor %}
		</ul>
	</div>
	{% comment %} 작성일자 댓글입력창 {% endcomment %}
	<small>{{post.created}}</small>
</div>



<div class="card-footer">
	<div class="post-comment-create">
		<form method="POST" action="{% url 'posts:comment_add' %}?next={{ action_redirect_url }}">
			{% csrf_token %}
			<input type="hidden" name="post" value="{{ post.id }}" />
			{{ comment_form.content }}
			<button type="submit">게시</button>
		</form>
	</div>
</div>
</article>
</div>
</div>

